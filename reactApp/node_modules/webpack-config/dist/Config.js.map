{"version":3,"sources":["../src/Config.js"],"names":["commandNames","DEPENDENCY_TREE","COMMAND_FACTORY","Config","commandFactory","set","values","invoke","DEFAULTS","MERGE","EXTEND","config","dependencyTree","children","merge","toObject","properties","key","value","has","path","get"],"mappings":"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","file":"Config.js","sourcesContent":["import {\n    set,\n    unset,\n    get,\n    has\n} from 'lodash';\nimport ConfigDependency from './ConfigDependency';\nimport ConfigCommandInvoker from './ConfigCommandInvoker';\nimport * as commandNames from './ConfigCommandNames';\n\n/**\n * @private\n * @type {WeakMap}\n */\nconst DEPENDENCY_TREE = new WeakMap();\n\n/**\n * @private\n * @type {WeakMap}\n */\nconst COMMAND_FACTORY = new WeakMap();\n\n/**\n * @class\n */\nclass Config {\n    /**\n     * @constructor\n     * @param {ConfigCommandFactory} commandFactory\n     */\n    constructor(commandFactory) {\n        COMMAND_FACTORY.set(this, commandFactory);\n    }\n\n    /**\n     * @readonly\n     * @type {ConfigCommandFactory}\n     */\n    get commandFactory() {\n        return COMMAND_FACTORY.get(this);\n    }\n\n    /**\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * const config = new Config();\n     *\n     * config.extend('./test/fixtures/webpack.1.config.js');\n     *\n     * for (const {node} of config.dependencyTree) {\n     *   console.log(node.root.filename);\n     * }\n     * // ./test/fixtures/webpack.1.config.js\n     * // ./test/fixtures/webpack.2.config.js\n     * // ./test/fixtures/webpack.3.config.js\n     * // ./test/fixtures/webpack.5.config.js\n     * // ./test/fixtures/webpack.4.config.js\n     * @description Holds information about [included]{@link Config#extend} configs\n     * @readonly\n     * @type {ConfigDependency}\n     */\n    get dependencyTree() {\n        if (!DEPENDENCY_TREE.has(this)) {\n            DEPENDENCY_TREE.set(this, new ConfigDependency(this));\n        }\n\n        return DEPENDENCY_TREE.get(this);\n    }\n\n    /**\n     * @private\n     * @param {ConfigDependency} value\n     */\n    set dependencyTree(value) {\n        DEPENDENCY_TREE.set(this, value);\n    }\n\n    /**\n     * import Config from 'webpack-config';\n     *\n     * export default new Config().defaults({\n     *    debug: true\n     * }, {\n     *    profile: false\n     * });\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * export default new Config().defaults(() => {\n     *     return {\n     *         debug: true\n     *     };\n     * });\n     * @description Adds `values` if they are missing\n     * @param {...ConfigOptions} values\n     * @returns {Config}\n     */\n    defaults(...values) {\n        return ConfigCommandInvoker.invoke(commandNames.DEFAULTS, this, ...values);\n    }\n\n    /**\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * export default new Config().merge({\n     *    debug: true\n     * }, {\n     *    profile: false\n     * });\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * export default new Config().merge(() => {\n     *     return {\n     *         debug: true\n     *     };\n     * });\n     * @description Merges `values`\n     * @param {...ConfigOptions} values\n     * @returns {Config}\n     */\n    merge(...values) {\n        return ConfigCommandInvoker.invoke(commandNames.MERGE, this, ...values);\n    }\n\n    /**\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * export default new Config().extend('./test/fixtures/webpack.1.config.js');\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * // Loads from `node_modules/react-redux/webpack.config.js`\n     * export default new Config().extend('react-redux/webpack.config.js');\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * // Loads from `node_modules/webpack-config-my/webpack.config.js`\n     * export default new Config().extend('my/webpack.config.js');\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * export default new Config().extend({\n     *    './test/fixtures/webpack.1.config.js': config => {\n     *        delete config.tags;\n     *\n     *        return config;\n     *    }\n     * });\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * export default new Config().extend({\n     *    './test/fixtures/webpack.1.config.js': [config => {\n     *        delete config.tags;\n     *\n     *        return config;\n     *    }, config => {\n     *        delete config.profile;\n     *\n     *        return config;\n     *    }]\n     * });\n     * @description Helps to extend config using local file or shareable config file which should be hosted under `node_modules`\n     * @param {...ConfigExtendPossibleOptions} values\n     * @returns {Config}\n     */\n    extend(...values) {\n        return ConfigCommandInvoker.invoke(commandNames.EXTEND, this, ...values);\n    }\n\n    /**\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * const config = new Config();\n     *\n     * config.merge({\n     *   debug: true\n     * });\n     *\n     * console.log(config.clone());\n     * // Config { debug: true }\n     * @description Creates copy of {@link Config}\n     * @returns {Config}\n     */\n    clone() {\n        const config = new Config(this.commandFactory);\n\n        config.dependencyTree = new ConfigDependency(config, this.dependencyTree.children);\n\n        return config.merge(this.toObject());\n    }\n\n    /**\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * const config = new Config();\n     *\n     * config.merge({\n     *   debug: true\n     * });\n     *\n     * console.log(config.toObject());\n     * // Object { debug: true }\n     * @description Returns plain `Object` representation of {@link Config}\n     * @returns {Object}\n     */\n    toObject() {\n        const properties = {};\n\n        for (const [key, value] of Object.entries(this)) {\n            if (this.has(key)) {\n                properties[key] = value;\n            }\n        }\n\n        return properties;\n    }\n\n    /**\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * const config = new Config();\n     *\n     * config.set('debug', true);\n     *\n     * console.log(config.toObject());\n     * // Object { debug: true }\n     * @description Sets `value` at `path`\n     * @param {String} path\n     * @param {*} value\n     * @return {Config}\n     */\n    set(path, value) {\n        set(this, path, value);\n\n        return this;\n    }\n\n    /**\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * const config = new Config();\n     *\n     * config.set('debug', true);\n     *\n     * console.log(config.get('debug'));\n     * // true\n     * @description Gets `value` at `path`\n     * @param {String} path\n     * @return {*}\n     */\n    get(path) {\n        return get(this, path);\n    }\n\n    /**\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * const config = new Config();\n     *\n     * config.set('debug', true).remove('debug');\n     *\n     * console.log(config.get('debug'));\n     * // undefined\n     * @description Removes `value` at `path`\n     * @param {String} path\n     * @return {Config}\n     */\n    remove(path) {\n        unset(this, path);\n\n        return this;\n    }\n\n    /**\n     * @example\n     * import Config from 'webpack-config';\n     *\n     * const config = new Config();\n     *\n     * config.set('debug', true);\n     *\n     * console.log(config.has('debug'));\n     * // true\n     * @description Checks if `value` exist at `path`\n     * @param {String} path\n     * @return {Boolean}\n     */\n    has(path) {\n        return has(this, path);\n    }\n\n    /**\n     * @returns {Object}\n     */\n    toJSON() {\n        return this.toObject();\n    }\n}\n\nexport default Config;\n"]}